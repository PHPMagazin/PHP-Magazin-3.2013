class StreamMapper extends Emitor {  public function map() {    $this->onStartEmit();    while ( ($line = fgets(STDIN)) !== false) {      // do some normalization by trimming and       // working with lower letters only      $line = strtolower(trim($line));      // split the line into words      $words = preg_split('/\W/', $line, 0, PREG_SPLIT_NO_EMPTY);      foreach ($words as $word) {        // we are basically doing a "combine" here        // already        if (isset($this->emits[$word]))          $this->emits[$word] += 1;        else           $this->emits[$word] = 1;      }    }    ksort($this->emits);    $this->onEndEmit();  }} 